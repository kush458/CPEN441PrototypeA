<!--Making my portfolio website using HTML, CSS, Bootstrap and W3.CSS-->

<!DOCTYPE html>
<html>
<title>EZdegree</title>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<link rel="stylesheet" href="https://www.w3schools.com/w3css/4/w3.css">
<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Lato">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
<link rel="stylesheet" type="text/css" href="./style.css">
<!-- <script src="chatbot.js" type="text/javascript"></script> -->


<style>
  .mySlides {display:none;}
  </style>

<body>
<!-- Navbar (sit on top) -->
<div class="w3-top">
  <div class="w3-bar w3-white w3-wide w3-padding w3-card">
    <a href="#home" class="w3-bar-item w3-button"><b>EZ Degree</b></a>
    <!-- Float links to the right. Hide them on small screens -->
    <div class="w3-right w3-hide-small">
      <a href="#degreeSummary" class="w3-bar-item w3-button">Degree Summmary</a>
      <a href="#studentsLikeMe" class="w3-bar-item w3-button">Students Like Me</a>
      <a href="#help" class="w3-bar-item w3-button">Help</a>
    </div>
  </div>
</div>

<!-- Page content -->
<div class="w3-content w3-padding" style="max-width:1564px">

  <!-- degreeSummary Section -->
  <div class="w3-container w3-padding-32" id="degreeSummary">
    <h3 class="w3-border-bottom w3-border-light-grey w3-padding-16">Degree Summary</h3>
    <div class="w3-container">      
        <table class="w3-table-all w3-card-4">
          <thead>
            <tr class="w3-dark-gray">
              <th class="w3-center">Course Types</th>
              <th class="w3-center">Credits Completed</th>
              <th class="w3-center">Credits Missing</th>
            </tr>
          </thead>
          <tr>
            <td class="w3-center">First Year</td>
            <td class="w3-center">25</td>
            <td class="w3-center">-</td>
          </tr>
          <tr>
            <td class="w3-center">Second Year</td>
            <td class="w3-center">21</td>
            <td class="w3-center">9</td>
          </tr>
          <tr>
            <td class="w3-center">Third Year</td>
            <td class="w3-center">34</td>
            <td class="w3-center">-</td>
          </tr>
          <tr>
            <td class="w3-center">Fourth Year</td>
            <td class="w3-center">5</td>
            <td class="w3-center">10</td>
          </tr>
          <tr>
            <td class="w3-center">Electives</td>
            <td class="w3-center">15</td>
            <td class="w3-center">10</td>
          </tr>
          <tr>
            <td class="w3-center">Total</td>
            <td class="w3-center">100</td>
            <td class="w3-center">29</td>
          </tr>
        </table>
      </div>
  </div>

  <style>
    * {
      box-sizing: border-box;
    }
    
    /* Create three equal columns that floats next to each other */
    .column {
      float: left;
      width: 29%;
      margin: 25px;
      height: 400px; /* Should be removed. Only for demonstration */
    }
    
    /* Clear floats after the columns */
    .row:after {
      content: "";
      display: table;
      clear: both;
    }
  </style>

<!--studentsLikeMe -->
<div class="row" id="studentsLikeMe">
  <h3 class="w3-border-bottom w3-border-light-grey w3-padding-16">Students Like Me</h3>

  <div class="column" style="height: 500px;">
    <div class="w3-card w3-container w3-padding-16 w3-center">
        <h3>Your Personas</h3><br>
        <button class="w3-button w3-white w3-border w3-hover-border-black w3-round-large">Test 4-year grad plan</button>
        <p style="margin: 25px;"></p>
        <button class="w3-button w3-white w3-border w3-hover-border-black w3-round-large">Test 5-year grad plan</button>
        <p style="margin: 25px;"></p>
        <button class="w3-button w3-white w3-border w3-hover-border-black w3-round-large">Test 4-year plan with minor</button>
        <p style="margin: 25px;"></p>
        <button class="w3-button w3-white w3-border w3-hover-border-black w3-round-large">CPEN student with DSCI minor</button>
        <p style="margin: 25px;"></p>
        <button class="w3-button w3-white w3-border w3-hover-border-black w3-round-large">MECH student with MATH minor</button>
    </div>
  </div>

  <div class="column w3-display-container w3-center" style="height: 400px; width: 450px;">

    <div class="w3-display-container mySlides">
      <div class="w3-card w3-container w3-padding-16" style="width: 100%; align-items: center;">
          <h3>Manek, 45</h3><br>
          <i class="fa fa-id-badge" style="font-size:120px; align-content: center;"></i>
          <p>CPEN Student</p>
          <p><b>Interests</b>: in AI/ML</p>
          <p><b>Goal</b>: become ML Engineer</p>
          <button class="w3-button w3-white w3-border w3-hover-border-black w3-round-large">Compare your degree with Manek</button>
      </div>
    </div>

    <div class="w3-display-container mySlides ">
      <div class="w3-card w3-container w3-padding-16" style="width: 100%;">
          <h3>Kush, 42</h3><br>
          <i class="fa fa-id-badge" style="font-size:120px; align-content: center;"></i>
          <p>CIVL Student</p>
          <p><b>Interests</b>: in modern architecture</p>
          <p><b>Goal</b>: become Civil Engineer</p>
          <button class="w3-button w3-white w3-border w3-hover-border-black w3-round-large">Compare your degree with Kush</button>
      </div>
    </div>

    <div class="w3-display-container mySlides ">
      <div class="w3-card w3-container w3-padding-16" style="width: 100%;">
          <h3>Vincent, 44</h3><br>
          <i class="fa fa-id-badge" style="font-size:120px; align-content: center;"></i>
          <p>MECH Student</p>
          <p><b>Interests</b>: in automated systems</p>
          <p><b>Goal</b>: become Automation Engineer</p>
          <button class="w3-button w3-white w3-border w3-hover-border-black w3-round-large">Compare your degree with Vincent</button>
      </div>
    </div>

    <div class="w3-display-container mySlides ">
      <div class="w3-card w3-container w3-padding-16" style="width: 100%;">
          <h3>Parsa, 44</h3><br>
          <i class="fa fa-id-badge" style="font-size:120px; align-content: center;"></i>
          <p>CPEN Student</p>
          <p><b>Interests</b>: in Secure Systems</p>
          <p><b>Goal</b>: become Security Engineer</p>
          <button class="w3-button w3-white w3-border w3-hover-border-black w3-round-large">Compare your degree with Parsa</button>
      </div>
    </div>

    <div class="w3-display-container mySlides ">
      <div class="w3-card w3-container w3-padding-16" style="width: 100%;">
          <h3>So, 43</h3><br>
          <i class="fa fa-id-badge" style="font-size:120px; align-content: center;"></i>
          <p>ELEC Student</p>
          <p><b>Interests</b>: in microelectronics</p>
          <p><b>Goal</b>: become Systems Engineer</p>
          <button class="w3-button w3-white w3-border w3-hover-border-black w3-round-large">Compare your degree with So</button>
      </div>
    </div>

    <button class="w3-button w3-display-left w3-black" onclick="plusDivs(-1)">&#10094;</button>
    <button class="w3-button w3-display-right w3-black" onclick="plusDivs(1)">&#10095;</button>
    
  </div>

  <div class="column w3-display-container">
    <div class="w3-card w3-container w3-padding-16">
      <div>
        <h3 class="w3-center">Create a persona</h3><br>
        <form class="persona" action="#studentsLikeMe">
          <label for="fname">What is the name of this persona?</label>
          <input type="text" id="fname" name="firstname" placeholder="Persona name.."><br>
      
          <label for="lname">What is your plan after degree completion?</label>
          <input type="text" id="lname" name="lastname" placeholder="Grad School, Industry..."><br>

          <label for="lname">What is your desired salary?</label>
          <input type="text" id="lname" name="lastname" placeholder="90,000, 100,000..."><br>

          <label for="lname">What is your ideal work-life balance?</label>
          <input type="text" id="lname" name="lastname" placeholder="pro-social, career-oriented..."><br><br>
        
          <input type="submit" value="Submit">
        </form>
      </div>
    </div>
  </div>
  
</div>
  
<!-- Help Section -->
<div class="w3-container w3-padding-16" id="help">
    <h3 class="w3-border-bottom w3-border-light-grey">Help</h3>
</div>  

<button onclick="myFunction('Demo1')" class="w3-btn w3-block w3-dark-gray w3-left-align">How to do I create a persona?</button>
<div id="Demo1" class="w3-container w3-hide w3-light-gray">
  <h4>The follwing are the main steps to follow</h4>
  <p>.....</p>
</div>

<button onclick="myFunction('Demo2')" class="w3-btn w3-block w3-dark-gray w3-left-align">How to check my status?</button>
<div id="Demo2" class="w3-container w3-hide w3-light-gray">
  <h4>The follwing are the main steps to follow</h4>
  <p>.....</p>
</div>

<button onclick="myFunction('Demo3')" class="w3-btn w3-block w3-dark-gray w3-left-align">where is my profile?</button>
<div id="Demo3" class="w3-container w3-hide w3-light-gray">
  <h4>The follwing are the main steps to follow</h4>
  <p>.....</p>
</div>


  </div>
</div>

<div class="chatbot chatbot--closed">
    <div class="chatbot__header">
      <p><strong>Got a question?</strong> <span class="u-text-highlight">Ask EZbot</span></p>
      <svg class="chatbot__close-button icon-speech" viewBox="0 0 32 32">
        <use xlink:href="#icon-speech" />
      </svg>
      <svg class="chatbot__close-button icon-close" viewBox="0 0 32 32">
        <use xlink:href="#icon-close" />
      </svg>
    </div>
    <div class="chatbot__message-window">
      <ul class="chatbot__messages">
        <li class="is-ai animation">
          <div class="is-ai__profile-picture">
            <img src="./g.svg" style="height: 60px; width: 60px;"/>
          </div>
          <span class="chatbot__arrow chatbot__arrow--left"></span>
          <p class='chatbot__message'>Hi there üñê. I‚Äôm EZbot, your virtual assistant. I'm here to help with your general degree related enquiries.</p>
        </li>
        <!-- Answer and response added here -->
      </ul>
    </div>
    <div class="chatbot__entry chatbot--closed">
      <input type="text" class="chatbot__input" placeholder="Write a message..." />
      <svg class="chatbot__submit" viewBox="0 0 32 32">
        <use xlink:href="#icon-send" />
      </svg>
    </div>
  </div>
  
  <!-- Symbols -->
  <svg>
    <!-- Close icon -->
    <symbol id="icon-close" viewBox="0 0 32 32">
      <title>Close</title>
      <path d="M2.624 8.297l2.963-2.963 23.704 23.704-2.963 2.963-23.704-23.704z" />
      <path d="M2.624 29.037l23.704-23.704 2.963 2.963-23.704 23.704-2.963-2.963z" />
    </symbol>
  
    <!-- Speech icon -->
    <symbol id="icon-speech" viewBox="0 0 32 32">
      <title>Speech</title>
      <path d="M21.795 5.333h-11.413c-0.038 0-0.077 0-0.114 0l-0.134 0.011v2.796c0.143-0.006 0.273-0.009 0.385-0.009h11.277c0.070 0 7.074 0.213 7.074 7.695 0 5.179-2.956 7.695-9.036 7.695h-3.792c-0.691 0-1.12 0.526-1.38 1.159l-1.387 3.093-1.625 3.77 0.245 0.453h2.56l2.538-5.678h2.837c7.633 0 11.84-3.727 11.84-10.494 0.001-8.564-7.313-10.492-9.875-10.492z" />
      <path d="M10.912 24.259c-0.242-0.442-0.703-0.737-1.234-0.737-0 0-0 0-0 0h-0.56c-0.599-0.011-1.171-0.108-1.71-0.28l0.042 0.012c-1.82-0.559-4.427-2.26-4.427-7.424 0-6.683 5.024-7.597 7.109-7.686v-2.8c-2.042 0.095-9.91 1.067-9.91 10.483 0 4.832 1.961 7.367 3.606 8.64 1.38 1.067 3.109 1.744 4.991 1.843l0.033 0.019 2.805 5.211 1.41-3.273z" />
    </symbol>
  
    <!-- Send icon -->
    <symbol id="icon-send" viewBox="0 0 23.97 21.9">
      <title>Send</title>
      <path d="M0.31,9.43a0.5,0.5,0,0,0,0,.93l8.3,3.23L23.15,0Z"/>
      <path d="M9,14.6H9V21.4a0.5,0.5,0,0,0,.93.25L13.22,16l6,3.32A0.5,0.5,0,0,0,20,19l4-18.4Z"/>
    </symbol>
    
    <!-- Avatar icon -->
    <symbol id="avatar" width="32" height="32" viewBox="0 0 44.25 44">
      <title>Avatar</title>
      <path style="fill: #070708; fill-rule: evenodd;" d="M1035.88,1696.25a22,22,0,1,1-22.13,22A22.065,22.065,0,0,1,1035.88,1696.25Z" transform="translate(-1013.75 -1696.25)"/>
      <path style="fill: #fff; fill-rule: evenodd;" d="M1030.18,1725.16h2.35a0.335,0.335,0,0,0,.34-0.33v-5.23h5.94v5.23a0.342,0.342,0,0,0,.34.33h2.36a0.342,0.342,0,0,0,.34-0.33v-12.36a0.34,0.34,0,0,0-.34-0.32h-2.36a0.34,0.34,0,0,0-.34.32v4.51h-5.94v-4.51a0.333,0.333,0,0,0-.34-0.32h-2.35a0.333,0.333,0,0,0-.34.32v12.36a0.335,0.335,0,0,0,.34.33" transform="translate(-1013.75 -1696.25)"/>
    </symbol>
    
  </svg>


<!-- End page content -->
</div>

<!-- Footer -->
<footer class="w3-center w3-dark-grey w3-padding-16">
    <p>Powered by <a href="https://www.w3schools.com/w3css/default.asp" title="W3.CSS" target="_blank" style="color: #7ee0d2;">w3.css</a></p>
  </footer>

</body>
</html>

<script>
const accessToken = '3796899bd37c423bad3a21a25277bce0'
const baseUrl = 'https://api.api.ai/api/query?v=2015091001'
const sessionId = '20150910';
const loader = `<span class='loader'><span class='loader__dot'></span><span class='loader__dot'></span><span class='loader__dot'></span></span>`
const errorMessage = 'My apologies, I\'m not available at the moment, however, feel free to call our support team directly 0123456789.'
const urlPattern = /(\b(https?|ftp):\/\/[-A-Z0-9+&@#\/%?=~_|!:,.;]*[-A-Z0-9+&@#\/%=~_|])/gim
const $document = document
const $chatbot = $document.querySelector('.chatbot')
const $chatbotMessageWindow = $document.querySelector('.chatbot__message-window')
const $chatbotHeader = $document.querySelector('.chatbot__header')
const $chatbotMessages = $document.querySelector('.chatbot__messages')
const $chatbotInput = $document.querySelector('.chatbot__input')
const $chatbotSubmit = $document.querySelector('.chatbot__submit')

const botLoadingDelay = 1000
const botReplyDelay = 2000

document.addEventListener('keypress', event => {
  if (event.which == 13) validateMessage()
}, false)

$chatbotHeader.addEventListener('click', () => {
  toggle($chatbot, 'chatbot--closed')
  $chatbotInput.focus()
}, false)

$chatbotSubmit.addEventListener('click', () => {
  validateMessage()
}, false)

const toggle = (element, klass) => {
  const classes = element.className.match(/\S+/g) || [],
    index = classes.indexOf(klass)
  index >= 0 ? classes.splice(index, 1) : classes.push(klass)
  element.className = classes.join(' ')
}

const userMessage = content => {
  $chatbotMessages.innerHTML += `<li class='is-user animation'>
      <p class='chatbot__message' style="color: #ffffff">
        ${content}
      </p>
      <span class='chatbot__arrow chatbot__arrow--right'></span>
    </li>`
}

const aiMessage = (content, isLoading = false, delay = 0) => {
  setTimeout(() => {
    removeLoader()
    $chatbotMessages.innerHTML += `<li 
      class='is-ai animation' 
      id='${isLoading ? "is-loading" : ""}'>
        <div class="is-ai__profile-picture">
            <img src="./g.svg" style="height: 60px; width: 60px;"/>
        </div>
        <span class='chatbot__arrow chatbot__arrow--left'></span>
        <div class='chatbot__message'>${content}</div>
      </li>`
    scrollDown()
  }, delay)
}

const removeLoader = () => {
  let loadingElem = document.getElementById('is-loading')
  if (loadingElem) $chatbotMessages.removeChild(loadingElem)
}

const escapeScript = unsafe => {
  const safeString = unsafe
    .replace(/</g, ' ')
    .replace(/>/g, ' ')
    .replace(/&/g, ' ')
    .replace(/"/g, ' ')
    .replace(/\\/, ' ')
    .replace(/\s+/g, ' ')
  return safeString.trim()
}

const linkify = inputText => {
  return inputText.replace(urlPattern, `<a href='$1' target='_blank'>$1</a>`)
}

const validateMessage = () => {
  const text = $chatbotInput.value
  const safeText = text ? escapeScript(text) : ''
  if (safeText.length && safeText !== ' ') {
    resetInputField()
    userMessage(safeText)
    send(safeText)
  }
  scrollDown()
  return
}

const multiChoiceAnswer = text => {
  const decodedText = text.replace(/zzz/g, "'")
  userMessage(decodedText)
  send(decodedText)
  scrollDown()
  return
}

const processResponse = val => {
  if (val && val.fulfillment) {
    let output = ''
    let messagesLength = val.fulfillment.messages.length

    for (let i = 0; i < messagesLength; i++) {
      let message = val.fulfillment.messages[i]
      let type = message.type

      switch (type) {
        // 0 fulfillment is text
        case 0:
          let parsedText = linkify(message.speech)
          output += `<p>${parsedText}</p>`
          break

        // 1 fulfillment is card
        case 1:
          let imageUrl = message.imageUrl
          let imageTitle = message.title
          let imageSubtitle = message.subtitle
          let button = message.buttons[0]
          
          if(!imageUrl && !button && !imageTitle && !imageSubtitle) break

          output += `
            <a class='card' href='${button.postback}' target='_blank'>
              <img src='${imageUrl}' alt='${imageTitle}' />
            <div class='card-content'>
              <h4 class='card-title'>${imageTitle}</h4>
              <p class='card-title'>${imageSubtitle}</p>
              <span class='card-button'>${button.text}</span>
            </div>
            </a>
          `
          break

        // 2 fulfillment is a quick reply with multi-choice buttons
        case 2:
          let title = message.title
          let replies = message.replies
          let repliesLength = replies.length
          output += `<p>${title}</p>`

          for (let i = 0; i < repliesLength; i++) {
            let reply = replies[i]
            let encodedText = reply.replace(/'/g, 'zzz')
            output += `<button onclick='multiChoiceAnswer("${encodedText}")'>${reply}</button>`
          }
          break
      }
    }
    
    removeLoader()
    return output
  }

  removeLoader()
  return `<p>${errorMessage}</p>`
}

const setResponse = (val, delay = 0) => {
  setTimeout(() => {
    aiMessage(processResponse(val))
  }, delay)
}

const resetInputField = () => {
  $chatbotInput.value = ''
}

const scrollDown = () => {
  const distanceToScroll =
    $chatbotMessageWindow.scrollHeight -
    ($chatbotMessages.lastChild.offsetHeight + 60)
  $chatbotMessageWindow.scrollTop = distanceToScroll
  return false
}

const send = (text = '') => {
  fetch(`${baseUrl}&query=${text}&lang=en&sessionId=${sessionId}`, {
    method: 'GET',
    dataType: 'json',
    headers: {
      Authorization: 'Bearer ' + accessToken,
      'Content-Type': 'application/json; charset=utf-8'
    }
  })
  .then(response => response.json())
  .then(res => {
    if (res.status < 200 || res.status >= 300) {
      let error = new Error(res.statusText)
      throw error
    }
    return res
  })
  .then(res => {
    setResponse(res.result, botLoadingDelay + botReplyDelay)
  })
  .catch(error => {
    setResponse(errorMessage, botLoadingDelay + botReplyDelay)
    resetInputField()
    console.log(error)
  })

  aiMessage(loader, true, botLoadingDelay)
}
  var slideIndex = 1;
  showDivs(slideIndex);
  
  function plusDivs(n) {
    showDivs(slideIndex += n);
  }
  
  function showDivs(n) {
    var i;
    var x = document.getElementsByClassName("mySlides");
    if (n > x.length) {slideIndex = 1}
    if (n < 1) {slideIndex = x.length}
    for (i = 0; i < x.length; i++) {
       x[i].style.display = "none";  
    }
    x[slideIndex-1].style.display = "block";  
  }

  // Modal Image Gallery
    function onClick(element) {
    document.getElementById("img01").src = element.src;
    document.getElementById("modal01").style.display = "block";
    var captionText = document.getElementById("caption");
    captionText.innerHTML = element.alt;
    }

    function myFunction(id) {
    var x = document.getElementById(id);
    if (x.className.indexOf("w3-show") == -1) {
        x.className += " w3-show";
    } else { 
        x.className = x.className.replace(" w3-show", "");
    }
    }

</script>


</body>
</html> 